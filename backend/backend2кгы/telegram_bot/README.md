# Диаграмма взаимодействия

```mermaid
graph TD
    bot_init[Вход]
    cmd_start["/start"]
    cmd_admin["/admin"]
    cmd_support["/support"]

    support[Поддержка]
    dj_admin[Django admin]
   
    A[Приветствие]
    B1[Инструкция 1]
    B2[Инструкция 2]
    B3[Инструкция 3]
    C1[Получить доступ]
    D1[Реферальная ссылка брокера]
    E1[Внести депозит]
    F1[Основной функционал]
    G1[Обзор рынка]
    G2[Торговый бот]
    G3[Профиль]
    I1[Статус клиента]
    I2[Агент поддержки]

    K2[Мониторинг1]
    K3[Отключение мониторинга]
    K4[скриншот]

    L2[Мониторинг2]
    L3[Отключение мониторинга]
    L4[скриншот]

    bot_init --> cmd_start
    bot_init --> cmd_admin
    bot_init --> cmd_support

    cmd_start --> A
    cmd_admin --> dj_admin
    cmd_admin --> broadcast[Рассылка]
    cmd_support --> support 

    broadcast --> broadcast_selection[Выбор группы]
    
    A --> |Как это работает?| B1
    B1 --> |Далее| B2
    B2 --> |Далее| B3
    B3 --> C1
    C1 --> D1
    D1 --> |id подтвержден| E1
    D1 --> |id не подтвержден| A
    E1 --> |"депозит внесен (postback)"| F1
    E1 --> |"депозит не внесен (timeout)"| D1
    F1 --> G1
    F1 --> |Выбор валютных пар и таймфреймов|G2
    F1 --> G3

    G3 --> I1
    G3 --> I2
    
    G2 --> K2
    K2 --> K4
    K4 --> |сигнал| K4
    K4 --> K3
    K3 --> F1
    G2 --> L2
    L2 --> L4
    L4 --> |сигнал| L4
    L4 --> L3
    L3 --> F1

    I2 --> support
```

## Регистрация и депозит

К реферальной ссылке брокера прикрепляется user_id телеграм профиля + информация переданная через параметр start ссылки
на бота.

```
# Ссылка на бота
https://t.me/brarfhggxqncubot?start=реферальные_данные

# Ссылка на брокера
https://broker-link.com?partner_id=123&subid=user_id+реферальные_данные
```

Сервер брокера должен вернуть постбэки с этими данными. По ним будет наиден профиль пользователя в базе данных, в
котором будет отмечен его статус регистрации или депозита в зависимости от постбэка.